╔══════════════════════════════════════════════════════════════════════════════╗
║          NVDLA CONVOLUTION PIPELINE REGISTERS - QUICK REFERENCE              ║
║                                                                              ║
║  Pipeline: CDMA → CBUF → CSC → CMAC_A/B → CACC                             ║
║                                                                              ║
║  CDMA    (0x3000) - Convolution DMA: fetches data & weights from memory      ║
║  CSC     (0x4000) - Convolution Sequence Controller: schedules MAC ops       ║
║  CMAC_A  (0x5000) - Convolution MAC Array A: multiply-accumulate engine      ║
║  CMAC_B  (0x6000) - Convolution MAC Array B: multiply-accumulate engine      ║
║  CACC    (0x7000) - Convolution Accumulator: accumulates partial sums        ║
╚══════════════════════════════════════════════════════════════════════════════╝


═══════════════════════════════════════════════════════════════════════════════
              CDMA - CONVOLUTION DMA (Base: 0x3000)
              Fetches input data and weights from DRAM/SRAM into CBUF
═══════════════════════════════════════════════════════════════════════════════

┌──────────────────────────────────────────────────────────────────────────────┐
│ REGISTER NAME                    ADDR     SHIFTED   ACCESS   PURPOSE         │
├──────────────────────────────────────────────────────────────────────────────┤
│ S_STATUS                         0x3000   0x0C00    Read     Status of reg   │
│                                                               groups 0/1      │
├──────────────────────────────────────────────────────────────────────────────┤
│ S_POINTER                        0x3004   0x0C01    RW       Producer/       │
│                                                               consumer ptr    │
├──────────────────────────────────────────────────────────────────────────────┤
│ S_ARBITER                        0x3008   0x0C02    RW       DMA arbitration │
│                                                               weight/WMB      │
├──────────────────────────────────────────────────────────────────────────────┤
│ S_CBUF_FLUSH_STATUS              0x300C   0x0C03    Read     CBUF flush done │
│                                                               status          │
├──────────────────────────────────────────────────────────────────────────────┤
│ D_OP_ENABLE                      0x3010   0x0C04    RW       Enable conv DMA │
│                                                               operation       │
├──────────────────────────────────────────────────────────────────────────────┤
│ D_MISC_CFG                       0x3014   0x0C05    RW       Conv mode,      │
│                                                               precision,      │
│                                                               data/wt reuse   │
├──────────────────────────────────────────────────────────────────────────────┤
│ D_DATAIN_FORMAT                  0x3018   0x0C06    RW       Feature/Pixel,  │
│                                                               pixel format,   │
│                                                               mapping, sign   │
├──────────────────────────────────────────────────────────────────────────────┤
│ D_DATAIN_SIZE_0                  0x301C   0x0C07    RW       Input width &   │
│                                                               height          │
├──────────────────────────────────────────────────────────────────────────────┤
│ D_DATAIN_SIZE_1                  0x3020   0x0C08    RW       Input channel   │
│                                                               count           │
├──────────────────────────────────────────────────────────────────────────────┤
│ D_DATAIN_SIZE_EXT_0              0x3024   0x0C09    RW       Extended W/H    │
│                                                               (Winograd)      │
├──────────────────────────────────────────────────────────────────────────────┤
│ D_PIXEL_OFFSET                   0x3028   0x0C0A    RW       Pixel X/Y       │
│                                                               offset          │
├──────────────────────────────────────────────────────────────────────────────┤
│ D_DAIN_RAM_TYPE                  0x302C   0x0C0B    RW       Input RAM type  │
│                                                               (CVIF/MCIF)     │
├──────────────────────────────────────────────────────────────────────────────┤
│ D_DAIN_ADDR_HIGH_0               0x3030   0x0C0C    RW       Input data addr │
│                                                               [63:32]         │
├──────────────────────────────────────────────────────────────────────────────┤
│ D_DAIN_ADDR_LOW_0                0x3034   0x0C0D    RW       Input data addr │
│                                                               [31:0]          │
├──────────────────────────────────────────────────────────────────────────────┤
│ D_DAIN_ADDR_HIGH_1               0x3038   0x0C0E    RW       UV plane addr   │
│                                                               [63:32]         │
├──────────────────────────────────────────────────────────────────────────────┤
│ D_DAIN_ADDR_LOW_1                0x303C   0x0C0F    RW       UV plane addr   │
│                                                               [31:0]          │
├──────────────────────────────────────────────────────────────────────────────┤
│ D_LINE_STRIDE                    0x3040   0x0C10    RW       Line stride     │
│                                                               (bytes)         │
├──────────────────────────────────────────────────────────────────────────────┤
│ D_LINE_UV_STRIDE                 0x3044   0x0C11    RW       UV line stride  │
│                                                               (bytes)         │
├──────────────────────────────────────────────────────────────────────────────┤
│ D_SURF_STRIDE                    0x3048   0x0C12    RW       Surface stride  │
│                                                               (bytes)         │
├──────────────────────────────────────────────────────────────────────────────┤
│ D_DAIN_MAP                       0x304C   0x0C13    RW       Line/surface    │
│                                                               packed mode     │
├──────────────────────────────────────────────────────────────────────────────┤
│ D_RESERVED_X_CFG                 0x3050   0x0C14    RW       Reserved (do    │
│                                                               not touch)      │
├──────────────────────────────────────────────────────────────────────────────┤
│ D_RESERVED_Y_CFG                 0x3054   0x0C15    RW       Reserved (do    │
│                                                               not touch)      │
├──────────────────────────────────────────────────────────────────────────────┤
│ D_BATCH_NUMBER                   0x3058   0x0C16    RW       Batch count     │
│                                                               (1~32)          │
├──────────────────────────────────────────────────────────────────────────────┤
│ D_BATCH_STRIDE                   0x305C   0x0C17    RW       Batch stride    │
│                                                               (bytes)         │
├──────────────────────────────────────────────────────────────────────────────┤
│ D_ENTRY_PER_SLICE                0x3060   0x0C18    RW       CBUF entries    │
│                                                               per data slice  │
├──────────────────────────────────────────────────────────────────────────────┤
│ D_FETCH_GRAIN                    0x3064   0x0C19    RW       Fetch grain     │
│                                                               (slices)        │
├──────────────────────────────────────────────────────────────────────────────┤
│ D_WEIGHT_FORMAT                  0x3068   0x0C1A    RW       Uncompressed/   │
│                                                               Compressed      │
├──────────────────────────────────────────────────────────────────────────────┤
│ D_WEIGHT_SIZE_0                  0x306C   0x0C1B    RW       Bytes per       │
│                                                               kernel          │
├──────────────────────────────────────────────────────────────────────────────┤
│ D_WEIGHT_SIZE_1                  0x3070   0x0C1C    RW       Number of       │
│                                                               kernels         │
├──────────────────────────────────────────────────────────────────────────────┤
│ D_WEIGHT_RAM_TYPE                0x3074   0x0C1D    RW       Weight RAM type │
│                                                               (CVIF/MCIF)     │
├──────────────────────────────────────────────────────────────────────────────┤
│ D_WEIGHT_ADDR_HIGH               0x3078   0x0C1E    RW       Weight addr     │
│                                                               [63:32]         │
├──────────────────────────────────────────────────────────────────────────────┤
│ D_WEIGHT_ADDR_LOW                0x307C   0x0C1F    RW       Weight addr     │
│                                                               [31:0]          │
├──────────────────────────────────────────────────────────────────────────────┤
│ D_WEIGHT_BYTES                   0x3080   0x0C20    RW       Total weight    │
│                                                               bytes           │
├──────────────────────────────────────────────────────────────────────────────┤
│ D_WGS_ADDR_HIGH                  0x3084   0x0C21    RW       WGS addr        │
│                                                               [63:32]         │
├──────────────────────────────────────────────────────────────────────────────┤
│ D_WGS_ADDR_LOW                   0x3088   0x0C22    RW       WGS addr        │
│                                                               [31:0]          │
├──────────────────────────────────────────────────────────────────────────────┤
│ D_WMB_ADDR_HIGH                  0x308C   0x0C23    RW       WMB addr        │
│                                                               [63:32]         │
├──────────────────────────────────────────────────────────────────────────────┤
│ D_WMB_ADDR_LOW                   0x3090   0x0C24    RW       WMB addr        │
│                                                               [31:0]          │
├──────────────────────────────────────────────────────────────────────────────┤
│ D_WMB_BYTES                      0x3094   0x0C25    RW       Total WMB bytes │
├──────────────────────────────────────────────────────────────────────────────┤
│ D_MEAN_FORMAT                    0x3098   0x0C26    RW       Mean subtract   │
│                                                               enable/disable  │
├──────────────────────────────────────────────────────────────────────────────┤
│ D_MEAN_GLOBAL_0                  0x309C   0x0C27    RW       Mean R/Y & G/U  │
│                                                               values          │
├──────────────────────────────────────────────────────────────────────────────┤
│ D_MEAN_GLOBAL_1                  0x30A0   0x0C28    RW       Mean B/V & A/X  │
│                                                               values          │
├──────────────────────────────────────────────────────────────────────────────┤
│ D_CVT_CFG                        0x30A4   0x0C29    RW       CVT enable &    │
│                                                               truncate bits   │
├──────────────────────────────────────────────────────────────────────────────┤
│ D_CVT_OFFSET                     0x30A8   0x0C2A    RW       CVT offset      │
│                                                               (signed 16b)    │
├──────────────────────────────────────────────────────────────────────────────┤
│ D_CVT_SCALE                      0x30AC   0x0C2B    RW       CVT scale       │
│                                                               (signed 16b)    │
├──────────────────────────────────────────────────────────────────────────────┤
│ D_CONV_STRIDE                    0x30B0   0x0C2C    RW       Conv X/Y stride │
├──────────────────────────────────────────────────────────────────────────────┤
│ D_ZERO_PADDING                   0x30B4   0x0C2D    RW       Padding L/R/T/B │
├──────────────────────────────────────────────────────────────────────────────┤
│ D_ZERO_PADDING_VALUE             0x30B8   0x0C2E    RW       Pad fill value  │
├──────────────────────────────────────────────────────────────────────────────┤
│ D_BANK                           0x30BC   0x0C2F    RW       CBUF data/wt    │
│                                                               bank alloc      │
├──────────────────────────────────────────────────────────────────────────────┤
│ D_NAN_FLUSH_TO_ZERO              0x30C0   0x0C30    RW       Flush NaN to    │
│                                                               zero option     │
├──────────────────────────────────────────────────────────────────────────────┤
│ D_NAN_INPUT_DATA_NUM             0x30C4   0x0C31    Read     NaN count in    │
│                                                               input data      │
├──────────────────────────────────────────────────────────────────────────────┤
│ D_NAN_INPUT_WEIGHT_NUM           0x30C8   0x0C32    Read     NaN count in    │
│                                                               weights         │
├──────────────────────────────────────────────────────────────────────────────┤
│ D_INF_INPUT_DATA_NUM             0x30CC   0x0C33    Read     Inf count in    │
│                                                               input data      │
├──────────────────────────────────────────────────────────────────────────────┤
│ D_INF_INPUT_WEIGHT_NUM           0x30D0   0x0C34    Read     Inf count in    │
│                                                               weights         │
├──────────────────────────────────────────────────────────────────────────────┤
│ D_PERF_ENABLE                    0x30D4   0x0C35    RW       Enable perf     │
│                                                               counters        │
├──────────────────────────────────────────────────────────────────────────────┤
│ D_PERF_DAT_READ_STALL            0x30D8   0x0C36    Read     Data read stall │
│                                                               cycles          │
├──────────────────────────────────────────────────────────────────────────────┤
│ D_PERF_WT_READ_STALL             0x30DC   0x0C37    Read     Weight read     │
│                                                               stall cycles    │
├──────────────────────────────────────────────────────────────────────────────┤
│ D_PERF_DAT_READ_LATENCY          0x30E0   0x0C38    Read     Data read total │
│                                                               latency cycles  │
├──────────────────────────────────────────────────────────────────────────────┤
│ D_PERF_WT_READ_LATENCY           0x30E4   0x0C39    Read     Weight read     │
│                                                               latency cycles  │
├──────────────────────────────────────────────────────────────────────────────┤
│ D_CYA                            0x30E8   0x0C3A    RW       CYA register    │
└──────────────────────────────────────────────────────────────────────────────┘
Total CDMA registers: 39


═══════════════════════════════════════════════════════════════════════════════
              CSC - CONVOLUTION SEQUENCE CONTROLLER (Base: 0x4000)
              Reads data/weights from CBUF, schedules MAC operations
═══════════════════════════════════════════════════════════════════════════════

┌──────────────────────────────────────────────────────────────────────────────┐
│ REGISTER NAME                    ADDR     SHIFTED   ACCESS   PURPOSE         │
├──────────────────────────────────────────────────────────────────────────────┤
│ S_STATUS                         0x4000   0x1000    Read     Status of reg   │
│                                                               groups 0/1      │
├──────────────────────────────────────────────────────────────────────────────┤
│ S_POINTER                        0x4004   0x1001    RW       Producer/       │
│                                                               consumer ptr    │
├──────────────────────────────────────────────────────────────────────────────┤
│ D_OP_ENABLE                      0x4008   0x1002    RW       Enable CSC      │
│                                                               operation       │
├──────────────────────────────────────────────────────────────────────────────┤
│ D_MISC_CFG                       0x400C   0x1003    RW       Conv mode,      │
│                                                               precision,      │
│                                                               reuse, skip     │
├──────────────────────────────────────────────────────────────────────────────┤
│ D_DATAIN_FORMAT                  0x4010   0x1004    RW       Feature/Pixel   │
│                                                               input format    │
├──────────────────────────────────────────────────────────────────────────────┤
│ D_DATAIN_SIZE_EXT_0              0x4014   0x1005    RW       Input extended  │
│                                                               width/height    │
├──────────────────────────────────────────────────────────────────────────────┤
│ D_DATAIN_SIZE_EXT_1              0x4018   0x1006    RW       Input extended  │
│                                                               channel         │
├──────────────────────────────────────────────────────────────────────────────┤
│ D_BATCH_NUMBER                   0x401C   0x1007    RW       Batch count     │
│                                                               (1~32)          │
├──────────────────────────────────────────────────────────────────────────────┤
│ D_POST_Y_EXTENSION               0x4020   0x1008    RW       Post Y ext      │
│                                                               (0~2)           │
├──────────────────────────────────────────────────────────────────────────────┤
│ D_ENTRY_PER_SLICE                0x4024   0x1009    RW       CBUF entries    │
│                                                               per slice       │
├──────────────────────────────────────────────────────────────────────────────┤
│ D_WEIGHT_FORMAT                  0x4028   0x100A    RW       Uncompressed/   │
│                                                               Compressed      │
├──────────────────────────────────────────────────────────────────────────────┤
│ D_WEIGHT_SIZE_EXT_0              0x402C   0x100B    RW       Weight width &  │
│                                                               height          │
├──────────────────────────────────────────────────────────────────────────────┤
│ D_WEIGHT_SIZE_EXT_1              0x4030   0x100C    RW       Weight channel  │
│                                                               & kernel count  │
├──────────────────────────────────────────────────────────────────────────────┤
│ D_WEIGHT_BYTES                   0x4034   0x100D    RW       Total weight    │
│                                                               bytes           │
├──────────────────────────────────────────────────────────────────────────────┤
│ D_WMB_BYTES                      0x4038   0x100E    RW       Total WMB bytes │
├──────────────────────────────────────────────────────────────────────────────┤
│ D_DATAOUT_SIZE_0                 0x403C   0x100F    RW       Output width &  │
│                                                               height          │
├──────────────────────────────────────────────────────────────────────────────┤
│ D_DATAOUT_SIZE_1                 0x4040   0x1010    RW       Output channel  │
│                                                               count           │
├──────────────────────────────────────────────────────────────────────────────┤
│ D_ATOMICS                        0x4044   0x1011    RW       W*H-1 output    │
│                                                               atomics         │
├──────────────────────────────────────────────────────────────────────────────┤
│ D_RELEASE                        0x4048   0x1012    RW       Slices to       │
│                                                               release         │
├──────────────────────────────────────────────────────────────────────────────┤
│ D_CONV_STRIDE_EXT                0x404C   0x1013    RW       Conv X/Y stride │
├──────────────────────────────────────────────────────────────────────────────┤
│ D_DILATION_EXT                   0x4050   0x1014    RW       X/Y dilation    │
│                                                               size            │
├──────────────────────────────────────────────────────────────────────────────┤
│ D_ZERO_PADDING                   0x4054   0x1015    RW       Pad left & top  │
├──────────────────────────────────────────────────────────────────────────────┤
│ D_ZERO_PADDING_VALUE             0x4058   0x1016    RW       Pad fill value  │
│                                                               (signed)        │
├──────────────────────────────────────────────────────────────────────────────┤
│ D_BANK                           0x405C   0x1017    RW       CBUF data/wt    │
│                                                               bank alloc      │
├──────────────────────────────────────────────────────────────────────────────┤
│ D_PRA_CFG                        0x4060   0x1018    RW       PRA truncate    │
│                                                               (0~2)           │
├──────────────────────────────────────────────────────────────────────────────┤
│ D_CYA                            0x4064   0x1019    RW       CYA register    │
└──────────────────────────────────────────────────────────────────────────────┘
Total CSC registers: 26


═══════════════════════════════════════════════════════════════════════════════
              CMAC_A - CONVOLUTION MAC ARRAY A (Base: 0x5000)
              Performs multiply-accumulate on data and weights
═══════════════════════════════════════════════════════════════════════════════

┌──────────────────────────────────────────────────────────────────────────────┐
│ REGISTER NAME                    ADDR     SHIFTED   ACCESS   PURPOSE         │
├──────────────────────────────────────────────────────────────────────────────┤
│ S_STATUS                         0x5000   0x1400    Read     Status of reg   │
│                                                               groups 0/1      │
├──────────────────────────────────────────────────────────────────────────────┤
│ S_POINTER                        0x5004   0x1401    RW       Producer/       │
│                                                               consumer ptr    │
├──────────────────────────────────────────────────────────────────────────────┤
│ D_OP_ENABLE                      0x5008   0x1402    RW       Enable CMAC_A   │
│                                                               operation       │
├──────────────────────────────────────────────────────────────────────────────┤
│ D_MISC_CFG                       0x500C   0x1403    RW       Conv mode &     │
│                                                               proc precision  │
└──────────────────────────────────────────────────────────────────────────────┘
Total CMAC_A registers: 4


═══════════════════════════════════════════════════════════════════════════════
              CMAC_B - CONVOLUTION MAC ARRAY B (Base: 0x6000)
              Performs multiply-accumulate on data and weights
═══════════════════════════════════════════════════════════════════════════════

┌──────────────────────────────────────────────────────────────────────────────┐
│ REGISTER NAME                    ADDR     SHIFTED   ACCESS   PURPOSE         │
├──────────────────────────────────────────────────────────────────────────────┤
│ S_STATUS                         0x6000   0x1800    Read     Status of reg   │
│                                                               groups 0/1      │
├──────────────────────────────────────────────────────────────────────────────┤
│ S_POINTER                        0x6004   0x1801    RW       Producer/       │
│                                                               consumer ptr    │
├──────────────────────────────────────────────────────────────────────────────┤
│ D_OP_ENABLE                      0x6008   0x1802    RW       Enable CMAC_B   │
│                                                               operation       │
├──────────────────────────────────────────────────────────────────────────────┤
│ D_MISC_CFG                       0x600C   0x1803    RW       Conv mode &     │
│                                                               proc precision  │
└──────────────────────────────────────────────────────────────────────────────┘
Total CMAC_B registers: 4


═══════════════════════════════════════════════════════════════════════════════
              CACC - CONVOLUTION ACCUMULATOR (Base: 0x7000)
              Accumulates partial sums, truncates, writes to SDP
═══════════════════════════════════════════════════════════════════════════════

┌──────────────────────────────────────────────────────────────────────────────┐
│ REGISTER NAME                    ADDR     SHIFTED   ACCESS   PURPOSE         │
├──────────────────────────────────────────────────────────────────────────────┤
│ S_STATUS                         0x7000   0x1C00    Read     Status of reg   │
│                                                               groups 0/1      │
├──────────────────────────────────────────────────────────────────────────────┤
│ S_POINTER                        0x7004   0x1C01    RW       Producer/       │
│                                                               consumer ptr    │
├──────────────────────────────────────────────────────────────────────────────┤
│ D_OP_ENABLE                      0x7008   0x1C02    RW       Enable CACC     │
│                                                               operation       │
├──────────────────────────────────────────────────────────────────────────────┤
│ D_MISC_CFG                       0x700C   0x1C03    RW       Conv mode &     │
│                                                               proc precision  │
├──────────────────────────────────────────────────────────────────────────────┤
│ D_DATAOUT_SIZE_0                 0x7010   0x1C04    RW       Output width &  │
│                                                               height          │
├──────────────────────────────────────────────────────────────────────────────┤
│ D_DATAOUT_SIZE_1                 0x7014   0x1C05    RW       Output channel  │
│                                                               count           │
├──────────────────────────────────────────────────────────────────────────────┤
│ D_DATAOUT_ADDR                   0x7018   0x1C06    RW       Output data     │
│                                                               address [31:0]  │
├──────────────────────────────────────────────────────────────────────────────┤
│ D_BATCH_NUMBER                   0x701C   0x1C07    RW       Batch count     │
│                                                               (1~32)          │
├──────────────────────────────────────────────────────────────────────────────┤
│ D_LINE_STRIDE                    0x7020   0x1C08    RW       Output line     │
│                                                               stride (bytes)  │
├──────────────────────────────────────────────────────────────────────────────┤
│ D_SURF_STRIDE                    0x7024   0x1C09    RW       Output surface  │
│                                                               stride (bytes)  │
├──────────────────────────────────────────────────────────────────────────────┤
│ D_DATAOUT_MAP                    0x7028   0x1C0A    RW       Line/surface    │
│                                                               packed mode     │
├──────────────────────────────────────────────────────────────────────────────┤
│ D_CLIP_CFG                       0x702C   0x1C0B    RW       Output clip     │
│                                                               truncate bits   │
├──────────────────────────────────────────────────────────────────────────────┤
│ D_OUT_SATURATION                 0x7030   0x1C0C    Read     Saturation      │
│                                                               count           │
├──────────────────────────────────────────────────────────────────────────────┤
│ D_CYA                            0x7034   0x1C0D    RW       CYA register    │
└──────────────────────────────────────────────────────────────────────────────┘
Total CACC registers: 14


═══════════════════════════════════════════════════════════════════════════════
SUMMARY:
  CDMA    = 39 registers  (0x3000 - 0x30E8)
  CSC     = 26 registers  (0x4000 - 0x4064)
  CMAC_A  =  4 registers  (0x5000 - 0x500C)
  CMAC_B  =  4 registers  (0x6000 - 0x600C)
  CACC    = 14 registers  (0x7000 - 0x7034)
  TOTAL   = 87 registers across full convolution pipeline
═══════════════════════════════════════════════════════════════════════════════

ACCESS LEGEND:
  Read  = Read-Only (RO)   - Status/counters, hardware writes
  RW    = Read/Write       - Configuration, software writes

NOTES:
• Shifted Address = Original Address >> 2 (divide by 4 for word addressing)
• Actual dimensions = Register value + 1 (e.g., WIDTH=0 means 1 pixel)
• All five stages must be configured consistently for each convolution layer
• S_POINTER must be set identically across all stages (same register group)
• D_OP_ENABLE must be written LAST on each stage to trigger operation
• CMAC_A and CMAC_B are identical arrays processing different kernel halves
• CACC output goes to SDP (Single Data Processor) for post-processing
• Performance counters require D_PERF_ENABLE first (CDMA only)
• WGS = Weight Group Status, WMB = Weight Mask Bits (for compression)
• CBUF has 32 banks total, split between data and weights via D_BANK
