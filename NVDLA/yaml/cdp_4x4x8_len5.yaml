# ═══════════════════════════════════════════════════════════════════
# NVDLA CDP — 4×4 spatial, 8 channels, LEN5 (5-channel window)
#
# Tests a wider normalization window across the channel dimension.
# With 8 channels and LEN5, edge channels use zero-padded neighbors.
#
#   Window for channel c: [max(0, c-2), min(7, c+2)]
#     c=0: channels [0, 1, 2]        → 3 active, 2 zero-padded
#     c=2: channels [0, 1, 2, 3, 4]  → full 5-channel window
#     c=7: channels [5, 6, 7]        → 3 active, 2 zero-padded
#
# Pipeline: CDP_RDMA → CvtIn → SqSum → LUT → Mul → CvtOut → WDMA
# ═══════════════════════════════════════════════════════════════════

test_suite:
  - name: "NVDLA_CDP_4x4x8_LEN5"
    description: "4×4×8 INT8 LRN, LEN5 (5-channel window)"

    layers:
      - type: "normalization"
        config:
          # --- input data cube ---
          input_shape: [4, 4, 8]        # [H, W, C]
          data_range: [-5, 5]
          data_format: "INT8"

          # --- LRN parameters ---
          normalz_len: 5                # 5-channel normalization window

          # --- LRN formula params ---
          k: 1.0
          alpha: 0.0001
          beta: 0.75

          # --- input conversion (identity) ---
          datin_offset: 0
          datin_scale: 1
          datin_shifter: 0

          # --- output conversion ---
          # datout_shifter=8 compensates for Q8.8 LUT format
          datout_offset: 0
          datout_scale: 1
          datout_shifter: 8

          # --- LUT configuration ---
          lut_le_function: "LINEAR"
          lut_priority: "LE"
