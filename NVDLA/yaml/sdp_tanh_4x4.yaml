# ═══════════════════════════════════════════════════════════════════
# NVDLA SDP Activation — Tanh (standalone, LUT-based)
#
# Pipeline: SDP_RDMA → SDP[EW: LUT tanh] → WDMA → DRAM
#
# Input:  4×4 spatial, 1 channel
# Output: 4×4 spatial, 1 channel
#
# Tanh behavior:
#   out = tanh(x)
#
# Implementation:
#   BS and BN stages are bypassed.
#   EW stage uses a 257-entry LO LUT + 65-entry LE LUT with
#   linear interpolation to approximate tanh.
#   LUT covers the full INT8 input range [-128, 128] so that the
#   hardware index calculation (integer subtraction + right-shift)
#   produces valid table indices for every possible input value.
#   LUT values stored as INT16 fixed-point (Q0.15, frac_bits=15).
#
# Output CVT: shift-8 to scale Q0.15 LUT values down to INT8
# ═══════════════════════════════════════════════════════════════════

test_suite:
  - name: "NVDLA_SDP_Tanh_4x4"
    description: "4×4 Tanh activation via standalone SDP (LUT)"

    layers:
      - type: "activation"
        config:
          activation_type: "tanh"
          input_shape: [4, 4]
          data_range: [-50, 50]
          data_format: "INT8"

          # LUT parameters
          lut_frac_bits: 15
          lut_range_min: -128
          lut_range_max: 128

          # Output CVT — scale Q0.15 LUT values down to INT8
          # tanh range [-1,1] × 2^15 = [-32768,32768]
          # >> 8 gives [-128,128] → saturated to [-128,127]
          cvt_offset: 0
          cvt_scale: 1
          cvt_shift: 8
